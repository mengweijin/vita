var W=Object.defineProperty,X=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var D=(l,t,a)=>t in l?W(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,N=(l,t)=>{for(var a in t||(t={}))te.call(t,a)&&D(l,a,t[a]);if(R)for(var a of R(t))ae.call(t,a)&&D(l,a,t[a]);return l},V=(l,t)=>X(l,ee(t));var I=(l,t,a)=>new Promise((v,h)=>{var y=r=>{try{p(a.next(r))}catch(x){h(x)}},b=r=>{try{p(a.throw(r))}catch(x){h(x)}},p=r=>r.done?v(r.value):Promise.resolve(r.value).then(y,b);p((a=a.apply(l,t)).next())});import{aB as j,d as le,r as ne,a as _,p as oe,n as L,m as se,e as c,A as ce,B as $,f as B,k as A,i as u,w,F as re,l as ie,b as de,g,a0 as ue,j as he,v as M,s as pe,u as H,t as me,Z as fe,_ as _e}from"./index-BOgzzpjy.js";import{d as ge}from"./delete-Ce0TSdK5.js";const ve={width:1024,height:1024,body:'<path fill="currentColor" d="M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"/>'},xe=()=>j.get("/monitor/cache/names"),ye=l=>j.get("/monitor/cache/query?cacheName="+l),be=(l,t)=>j.post("/monitor/cache/remove?cacheName="+l+"&cacheKey="+t),ke={class:"h-full bg-bg_color overflow-auto",style:{minHeight:"calc(100vh - 141px)",maxHeight:"calc(100vh - 141px)"}},we={class:"flex items-center h-[34px]"},Ce={style:{display:"flex","flex-direction":"row","justify-content":"space-between",width:"100%",cursor:"default"}},Ne=["onClick"],Ve={style:{padding:"0 15px"}},Ie={class:M(["pl-1","pr-3","rounded","flex","items-center","select-none","hover:text-primary"])},Be=["onClick"],je=le({__name:"tree",emits:["tree-select","reset-cache-value"],setup(l,{expose:t,emit:a}){const v=a,h=ne({}),y=_([]),b=_([]),p=_(!1),r=_(),x=_(!0),m=_(""),i=_({}),{proxy:S}=fe(),F={children:"children",label:"name"};oe(()=>["!h-[20px]","!text-sm","reset-margin","!text-[var(--el-text-color-regular)]","dark:!text-white","dark:hover:!text-primary"]);const K=(n,e)=>n?e.name.includes(n):!0;function U(n){var o,f;const e=n.$treeNodeId;i.value[e]=(o=i.value[e])!=null&&o.highlight?Object.assign({id:e},i.value[e],{highlight:!1}):Object.assign({id:e},i.value[e],{highlight:!0}),Object.values(i.value).forEach(d=>{d.id!==e&&(d.highlight=!1)}),v("tree-select",(f=i.value[e])!=null&&f.highlight?Object.assign(V(N({},n),{selected:!0})):Object.assign(V(N({},n),{selected:!1})))}function q(n){x.value=n;const e=S.$refs.treeRef.store._getAllNodes();for(let o=0;o<e.length;o++)e[o].expanded=n}function P(){i.value={},m.value="",q(!0)}function T(n,e){be(h.cacheName,e.key).then(()=>{const o=n.parent,f=o.data.children||o.data,d=f.findIndex(C=>C.key===e.key);f.splice(d,1),v("reset-cache-value")})}return L(m,n=>{r.value.filter(n)}),L(h,e=>I(this,[e],function*({cacheName:n}){p.value=!0;const o=yield ye(n);b.value=o,p.value=!1,v("reset-cache-value")})),t({onTreeReset:P}),se(()=>I(this,null,function*(){y.value=yield xe()})),(n,e)=>{const o=c("el-option"),f=c("el-select"),d=c("IconifyIconOffline"),C=c("el-icon"),Y=c("el-input");c("el-button"),c("el-dropdown-item"),c("el-dropdown-menu"),c("el-dropdown");const Z=c("el-divider"),G=c("el-tree"),J=ce("loading");return $((B(),A("div",ke,[u(f,{modelValue:h.cacheName,"onUpdate:modelValue":e[0]||(e[0]=s=>h.cacheName=s),placeholder:"请选择缓存名称",filterable:"",class:"!w-[180px]",style:{width:"100% !important",padding:"8px 8px"}},{default:w(()=>[(B(!0),A(re,null,ie(y.value,(s,k)=>(B(),de(o,{key:k,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),g("div",we,[u(Y,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),class:"ml-2",size:"small",placeholder:"请输入缓存 KEY 值",clearable:"",style:{"padding-right":"8px"}},{suffix:w(()=>[u(C,{class:"el-input__icon"},{default:w(()=>[$(u(d,{icon:"ri:search-line"},null,512),[[ue,m.value.length===0]])]),_:1})]),_:1},8,["modelValue"]),he("",!0)]),u(Z),u(G,{ref_key:"treeRef",ref:r,data:b.value,"node-key":"id",size:"small",props:F,"default-expand-all":"","expand-on-click-node":!1,"filter-node-method":K},{default:w(({node:s,data:k})=>{var O,z,E;return[g("span",Ce,[g("span",{class:M(["pl-1","pr-1","rounded","flex","items-center","select-none","hover:text-primary",m.value.trim().length>0&&s.label.includes(m.value)&&"text-red-500",(O=i.value[s.id])!=null&&O.highlight?"dark:text-primary":""]),style:pe({color:(z=i.value[s.id])!=null&&z.highlight?"var(--el-color-primary)":"",background:(E=i.value[s.id])!=null&&E.highlight?"var(--el-color-primary-light-7)":"transparent"}),onClick:Q=>U(k)},[u(d,{icon:H(ve)},null,8,["icon"]),g("a",Ve,me(s.label),1)],14,Ne),g("span",Ie,[g("a",{style:{"margin-left":"8px"},onClick:Q=>T(s,k)},[u(d,{icon:H(ge)},null,8,["icon"])],8,Be)])])]}),_:1},8,["data"])])),[[J,p.value]])}}}),Re=_e(je,[["__scopeId","data-v-dba06d27"]]);export{Re as default};
