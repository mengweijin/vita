var f=(o,r,i)=>new Promise((d,c)=>{var l=n=>{try{t(i.next(n))}catch(s){c(s)}},p=n=>{try{t(i.throw(n))}catch(s){c(s)}},t=n=>n.done?d(n.value):Promise.resolve(n.value).then(l,p);t((i=i.apply(o,r)).next())});import{_ as T}from"./detail.vue_vue_type_script_setup_true_lang-DERZNSmw.js";import{aB as S,r as m,a as g,m as D,ao as O,bo as R,af as F,L as _}from"./index-BOgzzpjy.js";import{useTableColumns as k}from"./table-columns-D5nX6wsJ.js";import"./detail-columns--PBOSfi9.js";import"./index-BRe61WGV.js";import"./dict-BGJzepeb.js";import"./vue-json-pretty-D1eGRSs8.js";const y=o=>S.get("/monitor/log-operation/page",{params:o}),h=o=>S.post("/monitor/log-operation/delete/"+o),{tableColumns:B}=k();function G(o){const r=m({}),i=g(),d=g([]),c=g(!0),l=g(0),p=g(B),t=m({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]});function n(e){h(e.id).then(u=>{u.code===200&&a()})}function s(){const e=o.value.getTableRef().getSelectionRows(),u=O(e,"id").join();h(u).then(P=>{P.code===200&&(o.value.getTableRef().clearSelection(),a())})}function v(e){l.value=e.length,o.value.setAdaptive()}function z(){l.value=0,o.value.getTableRef().clearSelection()}function C(e){t.pageSize=e,a()}function w(e){t.currentPage=e,a()}function a(){return f(this,null,function*(){c.value=!0,r.current=t.currentPage,r.size=t.pageSize;const e=yield y(R(r));d.value=e.records,t.pageSize=e.size,t.currentPage=e.current,t.total=e.total,setTimeout(()=>{c.value=!1},500)})}const b=e=>{e&&(e.resetFields(),a())};function L(e="操作日志",u){F({title:`${e}`,props:{row:u},width:"80%",draggable:!0,fullscreen:!0,fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>_(T,{row:null})})}return D(()=>f(this,null,function*(){a()})),{form:r,curRow:i,loading:c,columns:p,dataList:d,selectedNum:l,pagination:t,onSearch:a,resetForm:b,openDialog:L,handleDelete:n,onBatchDel:s,onSelectionCancel:z,handleSizeChange:C,handleCurrentChange:w,handleSelectionChange:v}}export{G as useLogOperation};
