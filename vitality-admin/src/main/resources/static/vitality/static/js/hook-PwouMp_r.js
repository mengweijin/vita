var h=(t,i,n)=>new Promise((p,c)=>{var g=l=>{try{a(n.next(l))}catch(d){c(d)}},s=l=>{try{a(n.throw(l))}catch(d){c(d)}},a=l=>l.done?p(l.value):Promise.resolve(l.value).then(g,s);a((n=n.apply(t,i)).next())});import{bc as m,e as S,r as u,o as w,I as x,ba as D,bn as H,a1 as j,bt as W,aa as B,aj as R}from"./index-CKX0gG-m.js";import{_ as F}from"./edit.vue_vue_type_script_setup_true_lang-CU7L4Fuy.js";import{_ as I}from"./detail.vue_vue_type_script_setup_true_lang-DAs6OZHB.js";import{R as $}from"./index-BkDFG21E.js";import"./detail-columns-CFwRHcXm.js";import"./dict-CsgBd1eO.js";import"./vue-json-pretty-BU-JBrgw.js";const O=t=>m.get("/monitor/log-alert/page",{params:t}),V=t=>m.post("/monitor/log-alert/create",{data:t}),q=t=>m.post("/monitor/log-alert/update",{data:t}),z=t=>m.post("/monitor/log-alert/delete/"+t);function ee(t){const i=S({}),n=u(),p=u([]),c=u(0),g=u(),s=u(!0),a=S({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),l=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!0},{label:"日志级别",prop:"logLevel",minWidth:90,cellRenderer:e=>x($,{code:"vtl_log_level",size:"small",value:e.row.logLevel},null)},{label:"日志信息",prop:"message",minWidth:280},{label:"异常名称",prop:"exceptionName",minWidth:180},{label:"类名称",prop:"className",minWidth:180},{label:"方法名称",prop:"methodName",minWidth:180},{label:"堆栈信息",prop:"stackTrace",minWidth:180,hide:!0},{label:"触发用户",minWidth:100,prop:"createByName",hide:!1},{label:"发生时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>D(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:e})=>D(e).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:200,slot:"operation"}];function d(e){z(e.id).then(()=>{o()})}function L(){const e=t.value.getTableRef().getSelectionRows(),r=H(e,"id").join();z(r).then(()=>{t.value.getTableRef().clearSelection(),o()})}function T(e){c.value=e.length,t.value.setAdaptive()}function Y(){c.value=0,t.value.getTableRef().clearSelection()}function _(e){a.pageSize=e,o()}function C(e){a.currentPage=e,o()}function o(){return h(this,null,function*(){s.value=!0,i.current=a.currentPage,i.size=a.pageSize;const e=yield O(j(i));p.value=e.records,a.total=e.total,a.pageSize=e.size,a.currentPage=e.current,setTimeout(()=>{s.value=!1},500)})}const M=e=>{e&&(e.resetFields(),o())};function N(e="新增",r){var b;W({title:`${e}`,props:{data:{id:(b=r==null?void 0:r.id)!=null?b:null}},width:"40%",draggable:!0,fullscreen:B(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>R(F,{ref:n,data:null}),beforeSure:(A,{options:P})=>{const f=P.props.data;function v(){A(),o()}n.value.getRef().validate(k=>{k&&(f.id?q(f).then(()=>{v()}):V(f).then(()=>{v()}))})}})}function y(e="详情",r){W({title:`${e}`,props:{data:r},width:"80%",draggable:!0,fullscreen:!0,fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>R(I,{data:null})})}return w(()=>h(this,null,function*(){o()})),{form:i,curRow:g,loading:s,columns:l,dataList:p,selectedNum:c,pagination:a,onSearch:o,resetForm:M,openEditDialog:N,openDetailDialog:y,handleDelete:d,handleBatchDelete:L,handleSelectionCancel:Y,handleSizeChange:_,handleCurrentChange:C,handleSelectionChange:T}}export{ee as useLogAlert};
