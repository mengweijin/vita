var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var L=(l,t,a)=>t in l?X(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,N=(l,t)=>{for(var a in t||(t={}))te.call(t,a)&&L(l,a,t[a]);if(z)for(var a of z(t))ae.call(t,a)&&L(l,a,t[a]);return l},V=(l,t)=>Z(l,ee(t));var I=(l,t,a)=>new Promise((v,h)=>{var y=r=>{try{p(a.next(r))}catch(x){h(x)}},b=r=>{try{p(a.throw(r))}catch(x){h(x)}},p=r=>r.done?v(r.value):Promise.resolve(r.value).then(y,b);p((a=a.apply(l,t)).next())});import{bc as B,w as le,e as ne,r as _,c as oe,B as D,o as se,E as c,ab as ce,F as H,p as O,q as S,I as u,S as w,K as re,L as ie,V as de,H as g,G as ue,R as he,O as K,J as pe,k as $,Q as me,i as fe,_ as _e}from"./index-DcU5f0E9.js";import{d as ge}from"./delete-Ce0TSdK5.js";const ve={width:1024,height:1024,body:'<path fill="currentColor" d="M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"/>'},xe=()=>B.get("/monitor/cache/names"),ye=l=>B.get("/monitor/cache/query?cacheName="+l),be=(l,t)=>B.post("/monitor/cache/remove?cacheName="+l+"&cacheKey="+t),ke={class:"h-full bg-bg_color overflow-auto",style:{minHeight:"calc(100vh - 141px)",maxHeight:"calc(100vh - 141px)"}},we={class:"flex items-center h-[34px]"},Ce={style:{display:"flex","flex-direction":"row","justify-content":"space-between",width:"100%",cursor:"default"}},Ne=["onClick"],Ve={style:{padding:"0 15px"}},Ie={class:K(["pl-1","pr-3","rounded","flex","items-center","select-none","hover:text-primary"])},Oe=["onClick"],Be=le({__name:"tree",emits:["tree-select","reset-cache-value"],setup(l,{expose:t,emit:a}){const v=a,h=ne({}),y=_([]),b=_([]),p=_(!1),r=_(),x=_(!0),m=_(""),i=_({}),{proxy:M}=fe(),q={children:"children",label:"name"};oe(()=>["!h-[20px]","!text-sm","reset-margin","!text-[var(--el-text-color-regular)]","dark:!text-white","dark:hover:!text-primary"]);const A=(n,e)=>n?e.name.includes(n):!0;function F(n){var o,f;const e=n.$treeNodeId;i.value[e]=(o=i.value[e])!=null&&o.highlight?Object.assign({id:e},i.value[e],{highlight:!1}):Object.assign({id:e},i.value[e],{highlight:!0}),Object.values(i.value).forEach(d=>{d.id!==e&&(d.highlight=!1)}),v("tree-select",(f=i.value[e])!=null&&f.highlight?Object.assign(V(N({},n),{selected:!0})):Object.assign(V(N({},n),{selected:!1})))}function U(n){x.value=n;const e=M.$refs.treeRef.store._getAllNodes();for(let o=0;o<e.length;o++)e[o].expanded=n}function G(){i.value={},m.value="",U(!0)}function J(n,e){be(h.cacheName,e.key).then(()=>{const o=n.parent,f=o.data.children||o.data,d=f.findIndex(C=>C.key===e.key);f.splice(d,1),v("reset-cache-value")})}return D(m,n=>{r.value.filter(n)}),D(h,e=>I(this,[e],function*({cacheName:n}){p.value=!0;const o=yield ye(n);b.value=o,p.value=!1,v("reset-cache-value")})),t({onTreeReset:G}),se(()=>I(this,null,function*(){y.value=yield xe()})),(n,e)=>{const o=c("el-option"),f=c("el-select"),d=c("IconifyIconOffline"),C=c("el-icon"),P=c("el-input");c("el-button"),c("el-dropdown-item"),c("el-dropdown-menu"),c("el-dropdown");const Q=c("el-divider"),T=c("el-tree"),Y=ce("loading");return H((O(),S("div",ke,[u(f,{modelValue:h.cacheName,"onUpdate:modelValue":e[0]||(e[0]=s=>h.cacheName=s),placeholder:"请选择缓存名称",filterable:"",class:"!w-[180px]",style:{width:"100% !important",padding:"8px"}},{default:w(()=>[(O(!0),S(re,null,ie(y.value,(s,k)=>(O(),de(o,{key:k,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),g("div",we,[u(P,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),class:"ml-2",size:"small",placeholder:"请输入缓存 KEY 值",clearable:"",style:{"padding-right":"8px"}},{suffix:w(()=>[u(C,{class:"el-input__icon"},{default:w(()=>[H(u(d,{icon:"ri:search-line"},null,512),[[ue,m.value.length===0]])]),_:1})]),_:1},8,["modelValue"]),he("",!0)]),u(Q),u(T,{ref_key:"treeRef",ref:r,data:b.value,"node-key":"id",size:"small",props:q,"default-expand-all":"","expand-on-click-node":!1,"filter-node-method":A},{default:w(({node:s,data:k})=>{var j,E,R;return[g("span",Ce,[g("span",{class:K(["pl-1","pr-1","rounded","flex","items-center","select-none","hover:text-primary",m.value.trim().length>0&&s.label.includes(m.value)&&"text-red-500",(j=i.value[s.id])!=null&&j.highlight?"dark:text-primary":""]),style:pe({color:(E=i.value[s.id])!=null&&E.highlight?"var(--el-color-primary)":"",background:(R=i.value[s.id])!=null&&R.highlight?"var(--el-color-primary-light-7)":"transparent"}),onClick:W=>F(k)},[u(d,{icon:$(ve)},null,8,["icon"]),g("a",Ve,me(s.label),1)],14,Ne),g("span",Ie,[g("a",{style:{"margin-left":"8px"},onClick:W=>J(s,k)},[u(d,{icon:$(ge)},null,8,["icon"])],8,Oe)])])]}),_:1},8,["data"])])),[[Y,p.value]])}}}),ze=_e(Be,[["__scopeId","data-v-3fe5eefc"]]);export{ze as default};
