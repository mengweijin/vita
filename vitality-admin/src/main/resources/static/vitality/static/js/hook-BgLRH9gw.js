var S=(a,i,l)=>new Promise((m,r)=>{var c=s=>{try{n(l.next(s))}catch(u){r(u)}},d=s=>{try{n(l.throw(s))}catch(u){r(u)}},n=s=>s.done?m(s.value):Promise.resolve(s.value).then(c,d);n((l=l.apply(a,i)).next())});import{aB as p,r as z,a as f,m as _,aX as P,ao as j,H as L,bo as X,af as A,X as $,L as q}from"./index-BOgzzpjy.js";import{_ as G}from"./form.vue_vue_type_script_setup_true_lang-D66Qbqoj.js";const J=a=>p.get("/system/oss/page",{params:a}),K=a=>p.post("/system/oss/create",{data:a}),Q=a=>p.post("/system/oss/update",{data:a}),R=a=>p.post("/system/oss/delete/"+a),U=a=>p.get("/system/oss/download/"+a,null,{responseType:"blob",beforeResponseCallback:()=>{}});function w(a){const i=z({}),l=f(),m=f(),r=f([]),c=f(!0),d=f(0),n=z({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),s=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!1},{label:"名称",prop:"name",minWidth:180},{label:"后缀名",prop:"suffix",minWidth:70,hide:!1},{label:"MD5",prop:"md5",minWidth:200,hide:!1},{label:"存储位置",prop:"storagePath",minWidth:260,hide:!0},{label:"创建者",minWidth:100,prop:"createByName",hide:!1},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>P(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:e})=>P(e).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:200,slot:"operation"}];function u(e){R(e.id).then(t=>{t.code===200&&o()})}function Y(){const e=a.value.getTableRef().getSelectionRows(),t=j(e,"id").join();R(t).then(h=>{h.code===200&&(a.value.getTableRef().clearSelection(),o())})}function C(e){d.value=e.length,a.value.setAdaptive()}function M(){d.value=0,a.value.getTableRef().clearSelection()}function T(e){n.pageSize=e,o()}function x(e){n.currentPage=e,o()}function O(e){U(e.id).then(t=>{L(t,e.name)})}function o(){return S(this,null,function*(){c.value=!0,i.current=n.currentPage,i.size=n.pageSize;const e=yield J(X(i));r.value=e.records,n.pageSize=e.size,n.currentPage=e.current,n.total=e.total,setTimeout(()=>{c.value=!1},500)})}const H=e=>{e&&(e.resetFields(),o())};function B(e="新增",t){var h,v,y,D;A({title:`${e}`,props:{formInline:{id:(h=t==null?void 0:t.id)!=null?h:null,name:(v=t==null?void 0:t.name)!=null?v:"",suffix:(y=t==null?void 0:t.suffix)!=null?y:"",storagePath:(D=t==null?void 0:t.storagePath)!=null?D:""}},width:"40%",draggable:!0,fullscreen:$(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>q(G,{ref:m,formInline:null}),beforeSure:(I,{options:k})=>{const F=m.value.getRef(),g=k.props.formInline;function W(){I(),o()}F.validate(N=>{N&&(g.id?Q(g).then(b=>{b.code===200&&W()}):K(g).then(b=>{b.code===200&&W()}))})}})}return _(()=>S(this,null,function*(){o()})),{form:i,curRow:l,loading:c,columns:s,dataList:r,selectedNum:d,pagination:n,onSearch:o,resetForm:H,openDialog:B,handleDelete:u,onBatchDel:Y,onSelectionCancel:M,handleSizeChange:T,handleCurrentChange:x,handleSelectionChange:C,handleDownload:O}}export{w as useOss};
