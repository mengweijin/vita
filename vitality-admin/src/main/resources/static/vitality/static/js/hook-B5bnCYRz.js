var b=(n,o,c)=>new Promise((m,s)=>{var r=i=>{try{a(c.next(i))}catch(d){s(d)}},u=i=>{try{a(c.throw(i))}catch(d){s(d)}},a=i=>i.done?m(i.value):Promise.resolve(i.value).then(r,u);a((c=c.apply(n,o)).next())});import{aB as g,r as z,a as f,m as j,aX as Y,ao as L,bo as X,af as A,X as O,L as $}from"./index-BOgzzpjy.js";import{_ as q}from"./form.vue_vue_type_script_setup_true_lang-DSAph6tm.js";const G=n=>g.get("/system/config/page",{params:n}),J=n=>g.post("/system/config/create",{data:n}),K=n=>g.post("/system/config/update",{data:n}),R=n=>g.post("/system/config/delete/"+n);function Z(n){const o=z({}),c=f(),m=f(),s=f([]),r=f(!0),u=f(0),a=z({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),i=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!0},{label:"名称",prop:"name",minWidth:180},{label:"编码",prop:"code",minWidth:180},{label:"值",prop:"val",minWidth:180},{label:"备注",prop:"remark",minWidth:160,hide:!1},{label:"创建者",minWidth:100,prop:"createByName",hide:!1},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>Y(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:e})=>Y(e).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:160,slot:"operation"}];function d(e){R(e.id).then(t=>{t.code===200&&l()})}function M(){const e=n.value.getTableRef().getSelectionRows(),t=L(e,"id").join();R(t).then(p=>{p.code===200&&(n.value.getTableRef().clearSelection(),l())})}function T(e){u.value=e.length,n.value.setAdaptive()}function k(){u.value=0,n.value.getTableRef().clearSelection()}function P(e){a.pageSize=e,l()}function B(e){a.currentPage=e,l()}function l(){return b(this,null,function*(){r.value=!0,o.current=a.currentPage,o.size=a.pageSize;const e=yield G(X(o));s.value=e.records,a.pageSize=e.size,a.currentPage=e.current,a.total=e.total,setTimeout(()=>{r.value=!1},500)})}const H=e=>{e&&(e.resetFields(),l())};function I(e="新增",t){var p,S,C,y,D;A({title:`${e}`,props:{formInline:{id:(p=t==null?void 0:t.id)!=null?p:null,name:(S=t==null?void 0:t.name)!=null?S:"",code:(C=t==null?void 0:t.code)!=null?C:"",val:(y=t==null?void 0:t.val)!=null?y:"",remark:(D=t==null?void 0:t.remark)!=null?D:""}},width:"40%",draggable:!0,fullscreen:O(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>$(q,{ref:m,formInline:null}),beforeSure:(x,{options:F})=>{const N=m.value.getRef(),h=F.props.formInline;function W(){x(),l()}N.validate(_=>{_&&(h.id?K(h).then(v=>{v.code===200&&W()}):J(h).then(v=>{v.code===200&&W()}))})}})}return j(()=>b(this,null,function*(){l()})),{form:o,curRow:c,loading:r,columns:i,dataList:s,selectedNum:u,pagination:a,onSearch:l,resetForm:H,openDialog:I,handleDelete:d,onBatchDel:M,onSelectionCancel:k,handleSizeChange:P,handleCurrentChange:B,handleSelectionChange:T}}export{Z as useConfig};
