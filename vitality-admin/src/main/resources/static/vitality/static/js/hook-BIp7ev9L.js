var v=(n,o,c)=>new Promise((m,s)=>{var r=i=>{try{a(c.next(i))}catch(d){s(d)}},u=i=>{try{a(c.throw(i))}catch(d){s(d)}},a=i=>i.done?m(i.value):Promise.resolve(i.value).then(r,u);a((c=c.apply(n,o)).next())});import{bc as g,e as z,r as f,o as _,ba as Y,bn as A,a1 as L,bt as O,aa as $,aj as q}from"./index-DcU5f0E9.js";import{_ as G}from"./form.vue_vue_type_script_setup_true_lang-Db5zdpEA.js";const J=n=>g.get("/system/config/page",{params:n}),K=n=>g.post("/system/config/create",{data:n}),Q=n=>g.post("/system/config/update",{data:n}),R=n=>g.post("/system/config/delete/"+n);function Z(n){const o=z({}),c=f(),m=f(),s=f([]),r=f(!0),u=f(0),a=z({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),i=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!0},{label:"名称",prop:"name",minWidth:180},{label:"编码",prop:"code",minWidth:180},{label:"值",prop:"val",minWidth:180},{label:"备注",prop:"remark",minWidth:160,hide:!1},{label:"创建者",minWidth:100,prop:"createByName",hide:!1},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>Y(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:e})=>Y(e).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:160,slot:"operation"}];function d(e){R(e.id).then(t=>{t.code===200&&l()})}function M(){const e=n.value.getTableRef().getSelectionRows(),t=A(e,"id").join();R(t).then(p=>{p.code===200&&(n.value.getTableRef().clearSelection(),l())})}function T(e){u.value=e.length,n.value.setAdaptive()}function k(){u.value=0,n.value.getTableRef().clearSelection()}function P(e){a.pageSize=e,l()}function H(e){a.currentPage=e,l()}function l(){return v(this,null,function*(){r.value=!0,o.current=a.currentPage,o.size=a.pageSize;const e=yield J(L(o));s.value=e.records,a.pageSize=e.size,a.currentPage=e.current,a.total=e.total,setTimeout(()=>{r.value=!1},500)})}const I=e=>{e&&(e.resetFields(),l())};function j(e="新增",t){var p,S,C,y,D;O({title:`${e}`,props:{formInline:{id:(p=t==null?void 0:t.id)!=null?p:null,name:(S=t==null?void 0:t.name)!=null?S:"",code:(C=t==null?void 0:t.code)!=null?C:"",val:(y=t==null?void 0:t.val)!=null?y:"",remark:(D=t==null?void 0:t.remark)!=null?D:""}},width:"40%",draggable:!0,fullscreen:$(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>q(G,{ref:m,formInline:null}),beforeSure:(x,{options:B})=>{const F=m.value.getRef(),h=B.props.formInline;function W(){x(),l()}F.validate(N=>{N&&(h.id?Q(h).then(b=>{b.code===200&&W()}):K(h).then(b=>{b.code===200&&W()}))})}})}return _(()=>v(this,null,function*(){l()})),{form:o,curRow:c,loading:r,columns:i,dataList:s,selectedNum:u,pagination:a,onSearch:l,resetForm:I,openDialog:j,handleDelete:d,onBatchDel:M,onSelectionCancel:k,handleSizeChange:P,handleCurrentChange:H,handleSelectionChange:T}}export{Z as useConfig};
