var S=(a,o,l)=>new Promise((m,r)=>{var c=s=>{try{n(l.next(s))}catch(u){r(u)}},d=s=>{try{n(l.throw(s))}catch(u){r(u)}},n=s=>s.done?m(s.value):Promise.resolve(s.value).then(c,d);n((l=l.apply(a,o)).next())});import{bc as p,e as z,r as f,o as N,ba as P,bn as _,aS as A,a1 as L,bt as $,aa as q,aj as G}from"./index-DcU5f0E9.js";import{_ as J}from"./form.vue_vue_type_script_setup_true_lang-CBssLBu8.js";const K=a=>p.get("/system/oss/page",{params:a}),Q=a=>p.post("/system/oss/create",{data:a}),U=a=>p.post("/system/oss/update",{data:a}),R=a=>p.post("/system/oss/delete/"+a),V=a=>p.get("/system/oss/download/"+a,null,{responseType:"blob",beforeResponseCallback:()=>{}});function w(a){const o=z({}),l=f(),m=f(),r=f([]),c=f(!0),d=f(0),n=z({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),s=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!1},{label:"名称",prop:"name",minWidth:180},{label:"后缀名",prop:"suffix",minWidth:70,hide:!1},{label:"MD5",prop:"md5",minWidth:200,hide:!1},{label:"存储位置",prop:"storagePath",minWidth:260,hide:!0},{label:"创建者",minWidth:100,prop:"createByName",hide:!1},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>P(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:e})=>P(e).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:200,slot:"operation"}];function u(e){R(e.id).then(t=>{t.code===200&&i()})}function Y(){const e=a.value.getTableRef().getSelectionRows(),t=_(e,"id").join();R(t).then(h=>{h.code===200&&(a.value.getTableRef().clearSelection(),i())})}function C(e){d.value=e.length,a.value.setAdaptive()}function M(){d.value=0,a.value.getTableRef().clearSelection()}function T(e){n.pageSize=e,i()}function x(e){n.currentPage=e,i()}function O(e){V(e.id).then(t=>{A(t,e.name)})}function i(){return S(this,null,function*(){c.value=!0,o.current=n.currentPage,o.size=n.pageSize;const e=yield K(L(o));r.value=e.records,n.pageSize=e.size,n.currentPage=e.current,n.total=e.total,setTimeout(()=>{c.value=!1},500)})}const H=e=>{e&&(e.resetFields(),i())};function I(e="新增",t){var h,v,y,D;$({title:`${e}`,props:{formInline:{id:(h=t==null?void 0:t.id)!=null?h:null,name:(v=t==null?void 0:t.name)!=null?v:"",suffix:(y=t==null?void 0:t.suffix)!=null?y:"",storagePath:(D=t==null?void 0:t.storagePath)!=null?D:""}},width:"40%",draggable:!0,fullscreen:q(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>G(J,{ref:m,formInline:null}),beforeSure:(j,{options:k})=>{const B=m.value.getRef(),g=k.props.formInline;function W(){j(),i()}B.validate(F=>{F&&(g.id?U(g).then(b=>{b.code===200&&W()}):Q(g).then(b=>{b.code===200&&W()}))})}})}return N(()=>S(this,null,function*(){i()})),{form:o,curRow:l,loading:c,columns:s,dataList:r,selectedNum:d,pagination:n,onSearch:i,resetForm:H,openDialog:I,handleDelete:u,onBatchDel:Y,onSelectionCancel:M,handleSizeChange:T,handleCurrentChange:x,handleSelectionChange:C,handleDownload:O}}export{w as useOss};
