var f=(o,r,c)=>new Promise((d,i)=>{var l=n=>{try{t(c.next(n))}catch(s){i(s)}},p=n=>{try{t(c.throw(n))}catch(s){i(s)}},t=n=>n.done?d(n.value):Promise.resolve(n.value).then(l,p);t((c=c.apply(o,r)).next())});import{_ as D}from"./detail.vue_vue_type_script_setup_true_lang-B2vX8Ew6.js";import{bc as S,e as m,r as g,o as L,bn as O,a1 as R,bt as F,aj as _}from"./index-DcU5f0E9.js";import{useTableColumns as j}from"./table-columns-D0Z5iscS.js";import"./detail-columns-CbAg6cdM.js";import"./index-o8UmT3vP.js";import"./dict-Bc4Ygahn.js";import"./vue-json-pretty-kRGc0fHA.js";const k=o=>S.get("/monitor/log-operation/page",{params:o}),h=o=>S.post("/monitor/log-operation/delete/"+o),{tableColumns:y}=j();function G(o){const r=m({}),c=g(),d=g([]),i=g(!0),l=g(0),p=g(y),t=m({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]});function n(e){h(e.id).then(u=>{u.code===200&&a()})}function s(){const e=o.value.getTableRef().getSelectionRows(),u=O(e,"id").join();h(u).then(T=>{T.code===200&&(o.value.getTableRef().clearSelection(),a())})}function v(e){l.value=e.length,o.value.setAdaptive()}function z(){l.value=0,o.value.getTableRef().clearSelection()}function C(e){t.pageSize=e,a()}function b(e){t.currentPage=e,a()}function a(){return f(this,null,function*(){i.value=!0,r.current=t.currentPage,r.size=t.pageSize;const e=yield k(R(r));d.value=e.records,t.pageSize=e.size,t.currentPage=e.current,t.total=e.total,setTimeout(()=>{i.value=!1},500)})}const w=e=>{e&&(e.resetFields(),a())};function P(e="操作日志",u){F({title:`${e}`,props:{row:u},width:"80%",draggable:!0,fullscreen:!0,fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>_(D,{row:null})})}return L(()=>f(this,null,function*(){a()})),{form:r,curRow:c,loading:i,columns:p,dataList:d,selectedNum:l,pagination:t,onSearch:a,resetForm:w,openDialog:P,handleDelete:n,onBatchDel:s,onSelectionCancel:z,handleSizeChange:C,handleCurrentChange:b,handleSelectionChange:v}}export{G as useLogOperation};
