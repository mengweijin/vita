var b=(n,r,s)=>new Promise((f,d)=>{var g=a=>{try{l(s.next(a))}catch(p){d(p)}},u=a=>{try{l(s.throw(a))}catch(p){d(p)}},l=a=>a.done?f(a.value):Promise.resolve(a.value).then(g,u);l((s=s.apply(n,r)).next())});import{aB as m,r as Y,a as c,m as V,i as I,e as U,aX as z,fv as X,ao as A,bo as E,af as C,X as M,L as P}from"./index-BOgzzpjy.js";import{_ as G}from"./edit.vue_vue_type_script_setup_true_lang-CTxD-hGP.js";import{_ as J}from"./detail.vue_vue_type_script_setup_true_lang-Bu5TA_wX.js";import"./detail-columns-B01AQPWs.js";import"./index-BRe61WGV.js";import"./dict-BGJzepeb.js";import"./vue-json-pretty-D1eGRSs8.js";const K=n=>m.get("/system/post/page",{params:n}),Q=n=>m.post("/system/post/create",{data:n}),T=n=>m.post("/system/post/update",{data:n}),W=n=>m.post("/system/post/delete/"+n);function se(n){const r=Y({}),s=c(),f=c([]),d=c(0),g=c(),u=c(!0),l=c({}),a=Y({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),p=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!0},{label:"名称",prop:"name",minWidth:180},{label:"状态",prop:"disabled",minWidth:90,cellRenderer:e=>{var t;return I(U("el-switch"),{size:e.props.size==="small"?"small":"default",loading:(t=l.value[e.index])==null?void 0:t.loading,modelValue:e.row.disabled,"onUpdate:modelValue":o=>e.row.disabled=o,"active-value":"N","inactive-value":"Y","active-text":"已启用","inactive-text":"已停用","inline-prompt":!0,style:"--el-switch-on-color: #6abe39; --el-switch-off-color: #e84749","before-change":()=>R(e)},null)}},{label:"排序",prop:"seq",minWidth:70,hide:!1},{label:"备注",prop:"remark",minWidth:160,hide:!0},{label:"创建者",minWidth:100,prop:"createByName",hide:!1},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:e})=>z(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",minWidth:100,prop:"updateByName",hide:!1},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:e})=>z(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"操作",fixed:"right",width:200,slot:"operation"}];function R({row:e,index:t}){return X.confirm(`确认要<strong>【${e.disabled==="Y"?"启用":"停用"}】</strong><strong style='color:var(--el-color-primary)'>${e.name} </strong>吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(()=>{l.value[t]=Object.assign({},l.value[t],{loading:!0})}).then(()=>{let o=e.disabled==="Y"?"N":"Y";T({id:e.id,disabled:o}).then(()=>{e.disabled=o})}).finally(()=>{l.value[t]=Object.assign({},l.value[t],{loading:!1})}),!1}function B(e){W(e.id).then(()=>{i()})}function k(){const e=n.value.getTableRef().getSelectionRows(),t=A(e,"id").join();W(t).then(()=>{n.value.getTableRef().clearSelection(),i()})}function x(e){d.value=e.length,n.value.setAdaptive()}function F(){d.value=0,n.value.getTableRef().clearSelection()}function N(e){a.pageSize=e,i()}function _(e){a.currentPage=e,i()}function i(){return b(this,null,function*(){u.value=!0,r.current=a.currentPage,r.size=a.pageSize;const e=yield K(E(r));f.value=e.records,a.total=e.total,a.pageSize=e.size,a.currentPage=e.current,setTimeout(()=>{u.value=!1},500)})}const H=e=>{e&&(e.resetFields(),i())};function $(e="新增",t){var o,v,y,S;C({title:`${e}`,props:{data:{id:(o=t==null?void 0:t.id)!=null?o:null,name:(v=t==null?void 0:t.name)!=null?v:"",seq:(y=t==null?void 0:t.seq)!=null?y:0,remark:(S=t==null?void 0:t.remark)!=null?S:""}},width:"40%",draggable:!0,fullscreen:M(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>P(G,{ref:s,data:null}),beforeSure:(L,{options:O})=>{const h=O.props.data;function D(){L(),i()}s.value.getRef().validate(q=>{q&&(h.id?T(h).then(()=>{D()}):Q(h).then(()=>{D()}))})}})}function j(e="详情",t){C({title:`${e}`,props:{data:t},width:"80%",draggable:!0,fullscreen:M(),fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>P(J,{data:null})})}return V(()=>b(this,null,function*(){i()})),{form:r,curRow:g,loading:u,columns:p,dataList:f,selectedNum:d,pagination:a,onSearch:i,resetForm:H,openEditDialog:$,openDetailDialog:j,handleDelete:B,handleBatchDelete:k,handleSelectionCancel:F,handleSizeChange:N,handleCurrentChange:_,handleSelectionChange:x}}export{se as usePost};
