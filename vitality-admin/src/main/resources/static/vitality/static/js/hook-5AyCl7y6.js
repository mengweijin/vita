var g=(t,r,o)=>new Promise((p,s)=>{var h=l=>{try{n(o.next(l))}catch(d){s(d)}},c=l=>{try{n(o.throw(l))}catch(d){s(d)}},n=l=>l.done?p(l.value):Promise.resolve(l.value).then(h,c);n((o=o.apply(t,r)).next())});import{bc as f,e as R,r as u,o as O,I as A,ba as y,bn as L,a1 as V,bt as Y,aa as q,aj as z}from"./index-DcU5f0E9.js";import{_ as E}from"./edit.vue_vue_type_script_setup_true_lang-RlyjHpZH.js";import{_ as G}from"./detail.vue_vue_type_script_setup_true_lang-6R8kAfLc.js";import{R as J}from"./index-o8UmT3vP.js";import"./index.esm-Dz2BCyq2.js";import"./dict-Bc4Ygahn.js";const K=t=>f.get("/system/notice/page",{params:t}),Q=t=>f.post("/system/notice/create",{data:t}),b=t=>f.post("/system/notice/update",{data:t}),C=t=>f.post("/system/notice/delete/"+t);function ne(t){const r=R({}),o=u(),p=u([]),s=u(0),h=u(),c=u(!0),n=R({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),l=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0,hide:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!0},{label:"标题",prop:"name",minWidth:180},{label:"发布状态",prop:"released",width:90,cellRenderer:e=>A(J,{code:"vtl_released",size:"small",value:e.row.released},null)},{label:"创建者",width:100,prop:"createByName",hide:!1},{label:"创建时间",width:160,prop:"createTime",formatter:({createTime:e})=>y(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",width:100,prop:"updateByName",hide:!1},{label:"最后更新时间",width:160,prop:"updateTime",formatter:({updateTime:e})=>y(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"操作",fixed:"right",width:280,slot:"operation"}];function d(e){C(e.id).then(()=>{i()})}function M(e){b({id:e.id,released:"Y"}).then(()=>{e.released="Y"})}function T(e){b({id:e.id,released:"N"}).then(()=>{e.released="N"})}function _(){const e=t.value.getTableRef().getSelectionRows(),a=L(e,"id").join();C(a).then(()=>{t.value.getTableRef().clearSelection(),i()})}function P(e){s.value=e.length,t.value.setAdaptive()}function H(){s.value=0,t.value.getTableRef().clearSelection()}function j(e){n.pageSize=e,i()}function k(e){n.currentPage=e,i()}function i(){return g(this,null,function*(){c.value=!0,r.current=n.currentPage,r.size=n.pageSize;const e=yield K(V(r));p.value=e.records,n.total=e.total,n.pageSize=e.size,n.currentPage=e.current,setTimeout(()=>{c.value=!1},500)})}const x=e=>{e&&(e.resetFields(),i())};function B(e="新增",a){var v,S,D;Y({title:`${e}`,props:{data:{id:(v=a==null?void 0:a.id)!=null?v:null,name:(S=a==null?void 0:a.name)!=null?S:"",description:(D=a==null?void 0:a.description)!=null?D:""}},width:"80%",draggable:!0,fullscreen:q(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>z(E,{ref:o,data:null}),beforeSure:(I,{options:W})=>{const m=W.props.data;function N(){I(),i()}o.value.getRef().validate($=>{$&&(m.id?b(m).then(()=>{N()}):Q(m).then(()=>{N()}))})}})}function F(e="通知/公告",a){Y({title:`${e}`,props:{data:a},width:"80%",draggable:!0,fullscreen:!0,fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>z(G,{data:null})})}return O(()=>g(this,null,function*(){i()})),{form:r,curRow:h,loading:c,columns:l,dataList:p,selectedNum:s,pagination:n,onSearch:i,resetForm:x,openEditDialog:B,openDetailDialog:F,handleDelete:d,handleBatchDelete:_,handleRelease:M,handleWithdraw:T,handleSelectionCancel:H,handleSizeChange:j,handleCurrentChange:k,handleSelectionChange:P}}export{ne as useNotice};
