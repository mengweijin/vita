var j=(s,u,l)=>new Promise((d,c)=>{var f=i=>{try{n(l.next(i))}catch(m){c(m)}},h=i=>{try{n(l.throw(i))}catch(m){c(m)}},n=i=>i.done?d(i.value):Promise.resolve(i.value).then(f,h);n((l=l.apply(s,u)).next())});import{_ as J}from"./form.vue_vue_type_script_setup_true_lang-DSxDf7Sd.js";import{r as K,a as v,m as Q,i as p,L as A,aa as b,F as w,aZ as B,aX as X,gn as ee,af as te,ad as ie,X as ne}from"./index-BOgzzpjy.js";import{g as ae,u as le,c as se,d as de}from"./menu-m-RuHVSn.js";import{u as me}from"./hooks-dHEbcyFv.js";import{R as U}from"./index-BRe61WGV.js";import"./index-0xZT4ftg.js";import"./index-Bu7FktmS.js";import"./index-D9SGE43O.js";import"./dict-BGJzepeb.js";function Te(){const s=K({title:""}),u=v(),l=v([]),d=v(!0),c=[{label:"菜单名称",prop:"title",align:"left",cellRenderer:({row:t})=>p(w,null,[p("span",{class:"inline-block mr-1"},[A(me(t.icon),{style:{paddingTop:"1px"}})]),p("span",null,[b(t.title)])]),minWidth:200},{label:"菜单类型",prop:"type",minWidth:100,cellRenderer:({row:t,props:e})=>p(U,{size:e.size,code:"vtl_menu_type",value:t.type},null)},{label:"路由名称",prop:"routerName",align:"left",minWidth:180},{label:"路由路径",prop:"routerPath",align:"left",minWidth:180},{label:"组件路径",prop:"componentPath",formatter:({routerPath:t,componentPath:e})=>B(e)?t:e,minWidth:180,hide:!0},{label:"权限标识",prop:"permission",align:"left",minWidth:200},{label:"内嵌页面地址",prop:"iframeSrc",align:"left",minWidth:180,hide:!0},{label:"隐藏",prop:"showLink",minWidth:60,cellRenderer:({row:t,props:e})=>p(U,{size:e.size,code:"vtl_yes_no",value:t.showLink==="Y"?"N":"Y"},null)},{label:"排序",prop:"seq",minWidth:60},{label:"创建者",minWidth:100,prop:"createByName",hide:!0},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:t})=>X(t).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:t})=>X(t).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:210,slot:"operation"}];function f(t){}function h(t){t&&(t.resetFields(),n())}function n(){return j(this,null,function*(){d.value=!0;let t=yield ae();B(s.title)||(t=t.filter(e=>b(e.title).includes(s.title))),l.value=ee(t),setTimeout(()=>{d.value=!1},500)})}function i(t){if(!t||!t.length)return;const e=[];for(let a=0;a<t.length;a++)t[a].title=b(t[a].title),i(t[a].children),e.push(t[a]);return e}function m(t="新增",e){var a,M,T,W,o,N,Y,y,D,I,R,P,k,x,_,S,F,H,z,L,O,q;te({title:`${t}菜单`,props:{formInline:{id:(a=e==null?void 0:e.id)!=null?a:null,type:(M=e==null?void 0:e.type)!=null?M:"MENU",parentId:(T=e==null?void 0:e.parentId)!=null?T:0,title:(W=e==null?void 0:e.title)!=null?W:"",routerName:(o=e==null?void 0:e.routerName)!=null?o:"",routerPath:(N=e==null?void 0:e.routerPath)!=null?N:"",componentPath:(Y=e==null?void 0:e.componentPath)!=null?Y:"",seq:(y=e==null?void 0:e.seq)!=null?y:1,redirect:(D=e==null?void 0:e.redirect)!=null?D:"",icon:(I=e==null?void 0:e.icon)!=null?I:"",extraIcon:(R=e==null?void 0:e.extraIcon)!=null?R:"",enterTransition:(P=e==null?void 0:e.enterTransition)!=null?P:"",leaveTransition:(k=e==null?void 0:e.leaveTransition)!=null?k:"",activePath:(x=e==null?void 0:e.activePath)!=null?x:"",permission:(_=e==null?void 0:e.permission)!=null?_:"",iframeSrc:(S=e==null?void 0:e.iframeSrc)!=null?S:"",iframeLoading:(F=e==null?void 0:e.iframeLoading)!=null?F:"N",keepAlive:(H=e==null?void 0:e.keepAlive)!=null?H:"N",hiddenTag:(z=e==null?void 0:e.hiddenTag)!=null?z:"N",fixedTag:(L=e==null?void 0:e.fixedTag)!=null?L:"N",showLink:(O=e==null?void 0:e.showLink)!=null?O:"Y",showParent:(q=e==null?void 0:e.showParent)!=null?q:"Y"},higherMenuOptions:i(ie(l.value))},width:"55%",draggable:!0,fullscreen:ne(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>A(J,{ref:u,formInline:null,higherMenuOptions:null}),beforeSure:(Z,{options:$})=>{const E=u.value.getRef(),g=$.props.formInline;function C(){Z(),n()}E.validate(G=>{G&&(g.id?le(g).then(r=>{r.code===200&&C()}):se(g).then(r=>{r.code===200&&C()}))})}})}function V(t){de(t.id).then(e=>{e.code===200&&n()})}return Q(()=>{n()}),{form:s,loading:d,columns:c,dataList:l,onSearch:n,resetForm:h,openDialog:m,handleDelete:V,handleSelectionChange:f}}export{Te as useMenu};
