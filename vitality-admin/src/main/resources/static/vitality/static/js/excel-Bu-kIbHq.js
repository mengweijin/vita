var E=Object.defineProperty,S=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var x=(s,e,o)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,w=(s,e)=>{for(var o in e||(e={}))B.call(e,o)&&x(s,o,e[o]);if(k)for(var o of k(e))z.call(e,o)&&x(s,o,e[o]);return s},v=(s,e)=>S(s,V(e));import{u as h,w as K}from"./xlsx-DaVhO591.js";import{w as N,E as _,p as A,V as T,S as u,H as y,I as m,T as f,k as $}from"./index-CKX0gG-m.js";const j={class:"font-medium"},F={class:"h-[25rem] mt-3"},R=N({name:"Excel",__name:"excel",setup(s){const e=(r=10,t="column-",n)=>Array.from({length:r}).map((c,a)=>v(w({},n),{key:`${t}${a}`,dataKey:`${t}${a}`,title:`Column ${a}`,width:150})),o=(r,t=200,n="row-")=>Array.from({length:t}).map((c,a)=>r.reduce((l,i,d)=>(l[i.dataKey]=`Row ${a} - Col ${d}`,l),{id:`${n}${a}`,parentId:null})),p=e(10),b=o(p,1e3),g=()=>{const r=b.map(a=>{const l=[];return p.forEach(i=>{l.push(a[i.dataKey])}),l}),t=[];p.forEach(a=>{t.push(a.title)}),r.unshift(t);const n=h.aoa_to_sheet(r),c=h.book_new();h.book_append_sheet(c,n,"数据报表"),K(c,"tableV2.xlsx")};return(r,t)=>{const n=_("el-link"),c=_("el-button"),a=_("el-table-v2"),l=_("el-auto-resizer"),i=_("el-card");return A(),T(i,{shadow:"never"},{header:u(()=>[y("div",j,[m(n,{href:"https://github.com/SheetJS/sheetjs",target:"_blank",style:{margin:"0 5px 4px 0","font-size":"16px"}},{default:u(()=>t[0]||(t[0]=[f(" 导出Excel ")])),_:1})]),m(n,{class:"mt-2",href:"https://github.com/pure-admin/vue-pure-admin/blob/main/src/views/able/excel.vue",target:"_blank"},{default:u(()=>t[1]||(t[1]=[f(" 代码位置 src/views/able/excel.vue ")])),_:1})]),default:u(()=>[m(c,{type:"primary",onClick:g},{default:u(()=>t[2]||(t[2]=[f("导出Excel")])),_:1}),y("div",F,[m(l,null,{default:u(({height:d,width:C})=>[m(a,{columns:$(p),data:$(b),width:C,height:d,fixed:""},null,8,["columns","data","width","height"])]),_:1})])]),_:1})}}});export{R as default};
