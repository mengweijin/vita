var g=(t,r,o)=>new Promise((p,s)=>{var m=i=>{try{n(o.next(i))}catch(d){s(d)}},c=i=>{try{n(o.throw(i))}catch(d){s(d)}},n=i=>i.done?p(i.value):Promise.resolve(i.value).then(m,c);n((o=o.apply(t,r)).next())});import{aB as f,r as y,a as u,m as j,i as I,aX as R,ao as L,bo as O,af as z,X as N,L as Y}from"./index-BOgzzpjy.js";import{_ as X}from"./edit.vue_vue_type_script_setup_true_lang-ZUunrrJf.js";import{_ as A}from"./detail.vue_vue_type_script_setup_true_lang-bq_kZQrq.js";import{R as V}from"./index-BRe61WGV.js";import"./index.esm-DVr8J6Gg.js";import"./detail-columns-CqG5NFQY.js";import"./dict-BGJzepeb.js";import"./vue-json-pretty-D1eGRSs8.js";const q=t=>f.get("/system/notice/page",{params:t}),E=t=>f.post("/system/notice/create",{data:t}),G=t=>f.post("/system/notice/update",{data:t}),_=t=>f.post("/system/notice/delete/"+t);function ne(t){const r=y({}),o=u(),p=u([]),s=u(0),m=u(),c=u(!0),n=y({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,30,50]}),i=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"编号",prop:"id",minWidth:180,align:"left",hide:!0},{label:"标题",prop:"name",minWidth:180},{label:"发布状态",prop:"released",width:90,cellRenderer:e=>I(V,{code:"vtl_yes_no",size:"small",value:e.row.released},null)},{label:"内容",prop:"description",minWidth:160,hide:!0},{label:"创建者",width:100,prop:"createByName",hide:!1},{label:"创建时间",width:160,prop:"createTime",formatter:({createTime:e})=>R(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"更新者",width:100,prop:"updateByName",hide:!1},{label:"最后更新时间",width:160,prop:"updateTime",formatter:({updateTime:e})=>R(e).format("YYYY-MM-DD HH:mm:ss"),hide:!1},{label:"操作",fixed:"right",width:200,slot:"operation"}];function d(e){_(e.id).then(()=>{l()})}function C(){const e=t.value.getTableRef().getSelectionRows(),a=L(e,"id").join();_(a).then(()=>{t.value.getTableRef().clearSelection(),l()})}function M(e){s.value=e.length,t.value.setAdaptive()}function T(){s.value=0,t.value.getTableRef().clearSelection()}function P(e){n.pageSize=e,l()}function B(e){n.currentPage=e,l()}function l(){return g(this,null,function*(){c.value=!0,r.current=n.currentPage,r.size=n.pageSize;const e=yield q(O(r));p.value=e.records,n.total=e.total,n.pageSize=e.size,n.currentPage=e.current,setTimeout(()=>{c.value=!1},500)})}const H=e=>{e&&(e.resetFields(),l())};function k(e="新增",a){var v,b,S;z({title:`${e}`,props:{data:{id:(v=a==null?void 0:a.id)!=null?v:null,name:(b=a==null?void 0:a.name)!=null?b:"",description:(S=a==null?void 0:a.description)!=null?S:""}},width:"80%",draggable:!0,fullscreen:N(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>Y(X,{ref:o,data:null}),beforeSure:(F,{options:W})=>{const h=W.props.data;function D(){F(),l()}o.value.getRef().validate($=>{$&&(h.id?G(h).then(()=>{D()}):E(h).then(()=>{D()}))})}})}function x(e="详情",a){z({title:`${e}`,props:{data:a},width:"80%",draggable:!0,fullscreen:N(),fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>Y(A,{data:null})})}return j(()=>g(this,null,function*(){l()})),{form:r,curRow:m,loading:c,columns:i,dataList:p,selectedNum:s,pagination:n,onSearch:l,resetForm:H,openEditDialog:k,openDetailDialog:x,handleDelete:d,handleBatchDelete:C,handleSelectionCancel:T,handleSizeChange:P,handleCurrentChange:B,handleSelectionChange:M}}export{ne as useNotice};
