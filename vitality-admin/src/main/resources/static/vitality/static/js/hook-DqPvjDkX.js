var L=(s,m,l)=>new Promise((d,c)=>{var f=i=>{try{n(l.next(i))}catch(p){c(p)}},h=i=>{try{n(l.throw(i))}catch(p){c(p)}},n=i=>i.done?d(i.value):Promise.resolve(i.value).then(f,h);n((l=l.apply(s,m)).next())});import{_ as Q}from"./form.vue_vue_type_script_setup_true_lang-XedaRny9.js";import{e as X,r as b,o as Z,I as u,aj as A,t as v,K as w,Y as B,ba as K,gC as ee,bt as te,a7 as ie,aa as ne}from"./index-DcU5f0E9.js";import{g as ae,u as le,c as se,d as de}from"./menu-FyRJYTHw.js";import{u as pe}from"./hooks-CU6ReGbj.js";import{R as U}from"./index-o8UmT3vP.js";import"./index-C4DFYXhp.js";import"./index-0yJxCH0D.js";import"./index-BXR3KV7k.js";import"./dict-Bc4Ygahn.js";function Te(){const s=X({title:""}),m=b(),l=b([]),d=b(!0),c=[{label:"菜单名称",prop:"title",align:"left",cellRenderer:({row:t})=>u(w,null,[u("span",{class:"inline-block mr-1"},[A(pe(t.icon),{style:{paddingTop:"1px"}})]),u("span",null,[v(t.title)])]),minWidth:200},{label:"菜单类型",prop:"type",minWidth:100,cellRenderer:({row:t,props:e})=>u(U,{size:e.size,code:"vtl_menu_type",value:t.type},null)},{label:"路由名称",prop:"routerName",align:"left",minWidth:180},{label:"路由路径",prop:"routerPath",align:"left",minWidth:180},{label:"组件路径",prop:"componentPath",formatter:({routerPath:t,componentPath:e})=>B(e)?t:e,minWidth:180,hide:!0},{label:"权限标识",prop:"permission",align:"left",minWidth:200},{label:"内嵌页面地址",prop:"iframeSrc",align:"left",minWidth:180,hide:!0},{label:"隐藏",prop:"showLink",minWidth:60,cellRenderer:({row:t,props:e})=>u(U,{size:e.size,code:"vtl_yes_no",value:t.showLink==="Y"?"N":"Y"},null)},{label:"排序",prop:"seq",minWidth:60},{label:"创建者",minWidth:100,prop:"createByName",hide:!0},{label:"创建时间",minWidth:160,prop:"createTime",formatter:({createTime:t})=>K(t).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"更新者",minWidth:100,prop:"updateByName",hide:!0},{label:"更新时间",minWidth:160,prop:"updateTime",formatter:({updateTime:t})=>K(t).format("YYYY-MM-DD HH:mm:ss"),hide:!0},{label:"操作",fixed:"right",width:210,slot:"operation"}];function f(t){}function h(t){t&&(t.resetFields(),n())}function n(){return L(this,null,function*(){d.value=!0;let t=yield ae();B(s.title)||(t=t.filter(e=>v(e.title).includes(s.title))),l.value=ee(t),setTimeout(()=>{d.value=!1},500)})}function i(t){if(!t||!t.length)return;const e=[];for(let a=0;a<t.length;a++)t[a].title=v(t[a].title),i(t[a].children),e.push(t[a]);return e}function p(t="新增",e){var a,M,T,o,W,Y,N,y,I,D,R,P,k,x,_,S,H,z,C,F,O,j;te({title:`${t}菜单`,props:{formInline:{id:(a=e==null?void 0:e.id)!=null?a:null,type:(M=e==null?void 0:e.type)!=null?M:"MENU",parentId:(T=e==null?void 0:e.parentId)!=null?T:0,title:(o=e==null?void 0:e.title)!=null?o:"",routerName:(W=e==null?void 0:e.routerName)!=null?W:"",routerPath:(Y=e==null?void 0:e.routerPath)!=null?Y:"",componentPath:(N=e==null?void 0:e.componentPath)!=null?N:"",seq:(y=e==null?void 0:e.seq)!=null?y:1,redirect:(I=e==null?void 0:e.redirect)!=null?I:"",icon:(D=e==null?void 0:e.icon)!=null?D:"",extraIcon:(R=e==null?void 0:e.extraIcon)!=null?R:"",enterTransition:(P=e==null?void 0:e.enterTransition)!=null?P:"",leaveTransition:(k=e==null?void 0:e.leaveTransition)!=null?k:"",activePath:(x=e==null?void 0:e.activePath)!=null?x:"",permission:(_=e==null?void 0:e.permission)!=null?_:"",iframeSrc:(S=e==null?void 0:e.iframeSrc)!=null?S:"",iframeLoading:(H=e==null?void 0:e.iframeLoading)!=null?H:"N",keepAlive:(z=e==null?void 0:e.keepAlive)!=null?z:"N",hiddenTag:(C=e==null?void 0:e.hiddenTag)!=null?C:"N",fixedTag:(F=e==null?void 0:e.fixedTag)!=null?F:"N",showLink:(O=e==null?void 0:e.showLink)!=null?O:"Y",showParent:(j=e==null?void 0:e.showParent)!=null?j:"Y"},higherMenuOptions:i(ie(l.value))},width:"55%",draggable:!0,fullscreen:ne(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>A(Q,{ref:m,formInline:null,higherMenuOptions:null}),beforeSure:($,{options:E})=>{const G=m.value.getRef(),g=E.props.formInline;function q(){$(),n()}G.validate(J=>{J&&(g.id?le(g).then(r=>{r.code===200&&q()}):se(g).then(r=>{r.code===200&&q()}))})}})}function V(t){de(t.id).then(e=>{e.code===200&&n()})}return Z(()=>{n()}),{form:s,loading:d,columns:c,dataList:l,onSearch:n,resetForm:h,openDialog:p,handleDelete:V,handleSelectionChange:f}}export{Te as useMenu};
