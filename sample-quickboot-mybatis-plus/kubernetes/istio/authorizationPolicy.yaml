# 跨命名空间服务之间认证策略
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: ns1-authorization-policy
  namespace: ns1
spec:
  action: ALLOW
  rules:
    - from:
        - source:
            # 只允许 namespace=ns1 中的服务访问，并且允许的命名空间必须都开启了Istio Label，否则依然无法访问成功
            namespaces: ["ns1"]
---
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: ns1-authorization-policy-2
  namespace: ns1
spec:
  action: ALLOW
  rules:
    - from:
        - source:
            # docker ip段的地址
            remoteIpBlocks: ["172.17.0.1"]
